#parse("Macros/cartPageMacro.vm")
#if($session.getAttribute("cartItemQtyUpdatedMessage") && $!session.getAttribute("cartItemQtyUpdatedMessage")!="")
<div id="notificationDivCart">
    <span class="errMsg" id="errorMsgCart">$!session.getAttribute("cartItemQtyUpdatedMessage")</span>
</div>
#end
#set($checkout="N")
#set($displayPriceHelp = "N")

<div id="notificationDiv"></div>
#set($savedCartItemId = 0) #if($productListData.size()>0)
#if($userLogin)
<input type="hidden" id="validEmailAddress" name="validEmailAddress" value="$!validEmailAddress">
#end
<form id="updateCartForm" action="updateShoppingCartPage.action" method="post">
    <input type="hidden" value="Y" name="isPunchoutCart" />
    <div class="row cart_Head">
    	<div class=" col-md-6">
    		<ul class="cartRow">
    			<li><h3>Shopping Cart</h3></li>
    			<li><a class="" href="$!locale.get('website.url.ProductCategory')"><i class="far fa-shopping-bag"></i>$!locale.get("product.button.continueShopping")</a></li>
    		</ul>
	    </div>
	    <div class=" col-md-6">
	    	<ul class="order_Items">
	    		<li>Total Item: $!cartCount</li>
	    		<li><span class="priceLabel">Order Total:</span><span class="priceValue">&nbsp;&nbsp;&nbsp;$ $numberTool.format("$numberToolFormat",$!cartTotal)</span></li>
	    		<li>
	            	#if($userLogin) 
		            	#if(($!session.getAttribute("isAdmin")=="Y" || $!session.getAttribute("isAuthPurchaseAgent")=="Y" || $!session.getAttribute("parentUserId")==0) && $!session.getAttribute("isGeneralUser")=="N")
							<a class="button" href="javascript:void(0);" #if($session.getAttribute("emailAddressExits")=="N") onclick="updateEmailAddressPopUp();" #else onclick="standardCheckout();"#end>$!locale.get("product.heading.checkout")</a>
						#else
							<a class="button" id="sendApproval" href="javascript:void(0);" onclick="sendApproval();">$!locale.get("product.button.submitforApproval")</a> 
						#end 
		            #else
		            	#if(($!CommonDBQuerySystemParameter.get("EnableAnonymousCheckout")=="Y" || $!CommonDBQuerySystemParameter.get("EnableAddToCartBeforeLogin")=="Y"))
		            	 <a class="button" href="/Login">$!locale.get("product.button.checkout")</a>
		            	#else
		            	<a class="button" href="javascript:void(0);" onclick="standardCheckout();">$!locale.get("product.heading.checkout")</a>
		            	#end
		            #end
           		</li>
	    	</ul>
	    </div>
    </div>
    <div class="row stepIndicators pullRight marginY-4">
    	<div class="col-md-12">
    		<ul>
    			<li><a class="currentClass">01:Step One Goes Here</a></li>
    			<li><a class="previousClass">02:Step Two Goes Here</a></li>
    			<li><a class="previousClass">03:Step Three Goes Here</a></li>
    		</ul>
    	</div>
    </div>
    <div class="row">
    	<div class="col-md-12">
    		<table class="table display rwd-table customBorderTable table-responsive" id="cartWrap" cellspacing="0" cellpadding="0">
	        	<thead>
	            	<tr>
	                	<th style="width: 270px">$!locale.get("product.label.productImage")</th>
	                	<th class="text-left">$!locale.get("product.label.description")</th>
	                    <th style="width: 160px">$!locale.get("product.heading.perUnitPrice")</th>
	                    <th style="width: 102px">$!locale.get("product.label.quantity")</th>
	                    <th style="width: 130px">$!locale.get("product.label.price")</th>
	                </tr>
	            </thead>
	            <tbody>
	                #foreach($itemData in $productListData)
	                <!--Cart content iterator-->
	                #set($itemTitle= $!itemData.brandName+" "+$!itemData.manufacturerPartNumber) #set($savedCartItemId = $!itemData.itemId)
	                <tr itemscope itemtype="http://schema.org/Product">
	                    <td data-th="$!locale.get('product.label.Image')">
	                        <div class="cimm_cartProdImg alignCenter">
	                            <a href="$!itemData.itemPriceId$!locale.get('website.url.ProductDetail')$!itemTitle.replace(' ','-').toLowerCase().replaceAll('&[#0-9a-z]+;','').replaceAll('[^a-zA-Z0-9\-\s]+','').replaceAll('--','-')">
	                                <span id="imageName$!itemData.itemId">
				                        #if($itemData.imageName.contains("http") || $itemData.imageType=="URL")
				                            <img itemprop="image" src="$!itemData.imageName" width="80" height="80" id="mainImage" alt='$itemData.imageName' onerror="this.src='$!webThemes/$!siteName/images/NoImage.png';" />
				                        #else
				                            <img itemprop="image" src="$!detailImage$!itemData.imageName"  width="80" height="80" alt='$itemData.imageName' onerror="this.src='$!webThemes/$!siteName/images/NoImage.png';" />
				                        #end
	                    			</span>
	                            </a>
	                        </div>
	                    </td>
	                    <td class="alignLeft" data-th="$!locale.get('product.label.description')">
	                        <div class="cimm_cartProdDescription">
	                        	<h4 class="item_title" itemprop="name"><a href="$!itemData.itemPriceId$!locale.get('website.url.ProductDetail')$!itemTitle.replace(' ','-').toLowerCase().replaceAll('&[#0-9a-z]+;','').replaceAll('[^a-zA-Z0-9\-\s]+','').replaceAll('--','-')">$!itemData.brandName $!itemData.manufacturerPartNumber</a></h4>
	                            <ul>
	                                <li>
	                                    #if($itemData.shortDesc.length()>85)
		                                    <p itemprop="description"> $!itemData.shortDesc.substring(0, 85)
		                                        <a href="$!itemData.itemPriceId$!locale.get('website.url.ProductDetail')$!itemTitle.replace(' ','-').toLowerCase().replaceAll('&[#0-9a-z]+;','').replaceAll('[^a-zA-Z0-9\-\s]+','').replaceAll('--','-')"> $!locale.get("product.label.more")</a>
		                                    </p>
	                                    #else
	                                    	<p itemprop="description"> $!itemData.shortDesc </p>
	                                    #end
	                                    <div id="minErr_$!itemData.itemPriceId"></div>
	                                </li>
	                                #if($itemData.brandName != "" && $!itemData.brandName)
	                                <li id="itemUom" itemprop="sku" class="cart_Style">
										$!locale.get("product.label.brandName"):<span>$!itemData.brandName</span>
	                                </li>
	 								#end
	                                <li itemprop="sku" class="cart_Style">$!locale.get("product.label.partNumber"):<span>$!itemData.partNumber</span></li>
	                                #set($leadTime = "N")
	                                #set($available = "N")
	                                #set($allBranch = $!itemData.branchAvail)
	                                #foreach($eachBranch in $allBranch)
	                                	#if($eachBranch.branchID==$!session.getAttribute("shipBranchId"))
		                                	#if($eachBranch.branchAvailability=="0")
		                                		#if($eachBranch.earliestMoreDays>0)
		                                			#set($leadTime = $!eachBranch.earliestMoreDays)
		                                		#else
		                                			#set($leadTime = $!eachBranch.plentyDays)
		                                		#end
		                                	#else
		                                		#set($available = $!eachBranch.branchAvailability)
		                                	#end
		                                	#break
	                                	#end
	                                #end
	                                #if($leadTime!="N" || $!available!="N")
	                                <li class="productLeadTime_$!itemData.partNumber.replaceAll('\s+','_') cart_Style" id="leadTimes" >
	                                	#if($leadTime!="N")
	                                	$!locale.get("product.label.leadTime"):<span class="orangeClr leadTime_$!itemData.partNumber.replaceAll('\s+','_')">$!leadTime Days</span>
	                                	#elseif($!available!="N")
	                                    <b>$!locale.get("product.label.availableQuantity"): </b><span>$!available</span>
	                                    #end
	                                </li>
	                                #end
	                                #if($itemData.customerPartNumberList && $!itemData.customerPartNumberList.size()>0)
				                    <!-- <li class="cart_Style">
				                        $!locale.get("product.label.customerpartnumber"):
				                        #set($seperator = "")
				                        #set($partList = "")
				                            #foreach($customerPart in $itemData.customerPartNumberList)
				                                #set($partList = "#if($partList)$!partList#end#if($seperator)$!seperator#end
				                                #if($customerPart.partNumber)$!customerPart.partNumber#end")
				                                	#set($seperator = ",")
				                           		#end
				                        	$!partList
				                    	</li> -->
				                	#end
				                	<div class="clear"></div>
				                	<li>
				                		<input type="text" class="lineItemComments" name="lineItemComment_$!itemData.productListId" id="lineItemComment_$!itemData.productListId" value="#if($itemData.lineItemComment)$!itemData.lineItemComment#end" placeholder='$!locale.get("product.label.lineItemComment")' />
				                	</li>
	                            </ul>
	                        </div>
	                    </td>
	                    <td data-th="$!locale.get('product.heading.perUnitPrice')">
	                    	#set($pricePreQty = 0)
	                    	#set($pricePreQty = $itemData.qty/$itemData.salesQuantity)
	                    	#if($itemData.uom)                    	                 	
	                        	<strong>$$!numberTool.format($!numberToolFormat,$!itemData.unitPrice) / $!itemData.uom ($!pricePreQty.intValue())</strong>
	                        #else
	                        	<strong>$$!numberTool.format($!numberToolFormat,$!itemData.unitPrice) / $!itemData.uomPack ($!pricePreQty.intValue())</strong>
	                        #end
	                        #if($itemData.unitPrice <= 0.0000 && $!checkout=="N")
					     		#set($checkout="Y")    
					     	#end
	                    </td>
	                    <td data-th="$!locale.get('form.label.tableQty')" class="cartUpdateBtn">
	                    	#cartHiddenFields($!itemData.partNumber, $!itemData.itemAvailability, $!itemData.productListId, $!itemData.qty, $!itemData.price, $!itemData.itemPriceId)
	                        <input type="text" id="textQty_$!itemData.partNumber.replaceAll('\s+','_')" data-itemId="$!itemData.itemPriceId" name="shoppingCartQty" maxlength="6" onkeypress="return IsNumeric(event);" onpaste="return false;" ondrop="return false;" class="quantity" value="$!itemData.qty" onblur="updateCart(this)" autocomplete="off" />
	                        <input type="hidden" id="cartQtyForAvail$!itemData.partNumber.replaceAll('\s+','_')$!itemData.productListId" name="cartQtyForAvail" value="$!itemData.qty">
	                        <input type="hidden" value="$!itemData.partNumber" id="PartNumber_$!itemData.partNumber.replaceAll('\s+','_')" name="partnumberStrArray" />
	                        <input type="hidden" value="$!itemData.minOrderQty" id="MinOrderQty_$!itemData.partNumber.replaceAll('\s+','_')" />
	                        <input type="hidden" value="$!itemData.orderInterval" id="OrderQtyInterval_$!itemData.partNumber.replaceAll('\s+','_')" name="orderQuantityInterval" />
	                        <input type="hidden" value="$!itemData.qty" id="itemQty_$!itemData.itemPriceId" />
	                        <a href="javascript:void(0);" class="updateLink" title='$!locale.get("product.button.update")' onclick='refreshShoppingCart($!itemData.productListId,"$!itemData.partNumber");return false;'>$!locale.get("product.button.update")</a>
	                    	<div class="cartUpdateBtn">
	                        	<a href="javascript:void(0);" data-toggle="tooltip" title="Delete Item" onclick="deleteItem('$!hostName/deleteCartPage.action?deleteId=$!itemData.productListId','0','$!escapeTool.javascript($!itemData.partNumber)');"><i class="fal fa-trash-alt"></i></a>
	                    	</div>
	                    </td>
	                    <td data-th="$!locale.get('product.label.extPrice')">
	                    	<strong class="formatPrice">$$!numberTool.format($!numberToolFormat,$!itemData.total)</strong>
	                    </td>
	                </tr>
	                #end
	                <!--End of Cart content iterator-->
	            </tbody>
	        </table>
    	</div>
    </div>
	
	<div class="row shoppingCart_Bottom">
    	<div class="col-md-8 cimm_btnGroupEnclosure">
			<ul class="clearAfter">
				<li><a class="" href="javascript:void(0);" onclick="deleteItem('$!hostName/deleteCartPage.action?deleteFlag=Y','1','')"><i class="far fa-shopping-cart"></i>$!locale.get("product.button.emptyCart")</a></li>
				<li><a class="" href="$!locale.get('website.url.ProductCategory')"><i class="fal fa-shopping-bag"></i>$!locale.get("product.button.continueShopping")</a></li>
				<li><a class="" href="javascript:void(0);" onclick="updateShoppingCart(); return false;"><i class="far fa-sync-alt"></i>$!locale.get("product.button.updateCart")</a></li>
				#if($userLogin)
					##if(($!session.getAttribute("isAdmin")=="Y" || $!session.getAttribute("isAuthPurchaseAgent")=="Y" || $!session.getAttribute("parentUserId")==0) && $!session.getAttribute("isGeneralUser")=="N")
					<li>
						#set($groupPop = "ulg"+$!savedCartItemId+"_custPop")
						<a id="$!groupPop" class="popMsg hideMe"></a>
						<a id='linkg$!savedCartItemId' class="dropdown" data-itemId="$!savedCartItemId" data-listTarget="ulg$!savedCartItemId" data-function="saveCartFunction">
							<i class="far fa-cart-arrow-down"></i>$!locale.get("product.button.saveCart")
						</a>
						<ul id="ulg$!savedCartItemId" class="customDropDown" style="display: none;"></ul>
					</li>
					##end
				#end						
			</ul>
    	</div>
        <div class="col-md-4 cimm_salesBottomStrip cimm_cartSalesBottomStrip">
			<ul>
				<li class="clearAfter">
			    	<span class="priceLabel">$!locale.get("product.label.total"):</span><span class="priceValue">$ $numberTool.format("$numberToolFormat",$!cartTotal)</span>
			    </li>
			</ul>
		</div>	
	</div>	
	
	<div class="checkout_Btn text-right">
		#if($userLogin) 
			#if(($!session.getAttribute("isAdmin")=="Y" || $!session.getAttribute("isAuthPurchaseAgent")=="Y" || $!session.getAttribute("parentUserId")==0) && $!session.getAttribute("isGeneralUser")=="N")
				<button type="button" class="btn" #if($session.getAttribute("emailAddressExits")=="N") onclick="updateEmailAddressPopUp();" #else onclick="standardCheckout();"#end>$!locale.get("product.heading.checkout")</button>
			#else
				<button type="button" class="btn" id="sendApproval" onclick="sendApproval();">$!locale.get("product.button.submitforApproval")</button> 
			#end 
		#else
		#if(($!CommonDBQuerySystemParameter.get("EnableAnonymousCheckout")=="Y" || $!CommonDBQuerySystemParameter.get("EnableAddToCartBeforeLogin")=="Y"))
			<a class="button" href="/Login">$!locale.get("product.button.checkout")</a>
		#else
			<button type="button" class="btn" onclick="standardCheckout();">$!locale.get("product.heading.checkout")</button>
		#end
		#end
	</div>		
</form>
<input type="hidden" value="$!checkout" id="checkoutpriceValue" name="checkoutpriceValue" />
<div class="clear"></div>
#refreshCartForm()
<input type="hidden" value="" id="hidden_id"/>
<input type="hidden" value="" id="group_id"/>
<input type="hidden" value="" id="group_name"/>
<input type="hidden" value="" name="deg" /> #else
<div class="elseCondition">
    <h4 align="center">$!locale.get("product.label.noCrtItms")</h4>
    <p class="marginY-5 text-center"><a class="button" href="$!locale.get('website.url.ProductCategory')">$!locale.get("product.button.continueShopping")</a></p>
</div>
#end

<!-----------------------------------------------End of Cart Page------------------------------------------>
<!-- Tracking Add to Cart & Items Added to the Cart -->
#if($productListData.size()>0 && $!CommonDBQuerySystemParameter.get("EnablePiwik") == 'Y')
<script>
	 #foreach($itemData in $productListData)

			piwik.addEcommerceItemPiwik("$!itemData.partNumber", "$!itemData.shortDesc.replaceAll('[^a-zA-Z0-9\-\s]+','')","$!itemData.categoryName", "$!itemData.unitPrice", "$!itemData.qty");

	 #end
 	
 		piwik.trackEcommerceCartUpdatePiwik("$!cartTotal");
 	</script>
 #end
<!-- Tracking Add to Cart & Items Added to the Cart -->